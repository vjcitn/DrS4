<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ClassSupport: from prototypical list to S4 class • DrS4</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ClassSupport: from prototypical list to S4 class">
<meta property="og:description" content="DrS4">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DrS4</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DrS4.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clgen.html">ClassSupport: from prototypical list to S4 class</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/DrS4">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="clgen_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ClassSupport: from prototypical list to S4 class</h1>
                        <h4 class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 class="date">October 03, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/DrS4/blob/master/vignettes/clgen.Rmd"><code>vignettes/clgen.Rmd</code></a></small>
      <div class="hidden name"><code>clgen.Rmd</code></div>

    </div>

    
    
<div id="purpose-reduce-tedium-of-s4-class-definition" class="section level1">
<h1 class="hasAnchor">
<a href="#purpose-reduce-tedium-of-s4-class-definition" class="anchor"></a>Purpose: reduce tedium of S4 class definition</h1>
<p>Given a prototypical list of elementary R data it is trivial but tedious to define a valid S4 class with appropriate getter and setter methods. DrS4’s <code>ClassSupport</code> class helps with this.</p>
</div>
<div id="example-turtle" class="section level1">
<h1 class="hasAnchor">
<a href="#example-turtle" class="anchor"></a>Example: Turtle</h1>
<p>Stuart Lee’s <a href="https://stuartlee.org/2019/07/09/s4-short-guide/">blog post on S4</a> inspires the default parameter settings in the <code>clgen</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DrS4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">clgen</span><span class="op">)</span></code></pre></div>
<pre><code>## function (clname = "Turtle", protolist = list(location = c(0, 
##     0), orientation = 0, path = matrix(c(0, 0), ncol = 2)), check_init = FALSE) 
## NULL</code></pre>
<div id="generate-the-basic-definitions" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-the-basic-definitions" class="anchor"></a>Generate the basic definitions</h2>
<p>Try it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tt</span> <span class="op">=</span> <span class="fu"><a href="../reference/clgen.html">clgen</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tt</span></code></pre></div>
<pre><code>## ClassSupport instance for Turtle 
##  slots:  location orientation path</code></pre>
<p>Learn a little more about this infrastructure:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">getClass</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Class "ClassSupport" [package "DrS4"]
## 
## Slots:
##                                                         
## Name:     clname   defcode   getters   setters protolist
## Class: character character      list      list      list</code></pre>
<p>We dump the code defining the class and its get/set methods.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dumpcs.html">dumpcs</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span></code></pre></div>
<pre><code>## setClass('Turtle', slots= c(location='numeric', orientation='numeric', path='matrix'), prototype=list(location = c(0, 0), orientation = 0, path = structure(c(0, 0), .Dim = 1:2)))
## setGeneric(name='location', def=function(x) standardGeneric('location'))
## setMethod(f='location', signature='Turtle', function(x) slot(x, 'location'))
## setGeneric(name='orientation', def=function(x) standardGeneric('orientation'))
## setMethod(f='orientation', signature='Turtle', function(x) slot(x, 'orientation'))
## setGeneric(name='path', def=function(x) standardGeneric('path'))
## setMethod(f='path', signature='Turtle', function(x) slot(x, 'path'))
## setGeneric(name='location&lt;-', def=function(x, value) standardGeneric('location&lt;-'))
## setMethod(f='location&lt;-', signature='Turtle', function(x, value) {slot(x, 'location') = value; x})
## setGeneric(name='orientation&lt;-', def=function(x, value) standardGeneric('orientation&lt;-'))
## setMethod(f='orientation&lt;-', signature='Turtle', function(x, value) {slot(x, 'orientation') = value; x})
## setGeneric(name='path&lt;-', def=function(x, value) standardGeneric('path&lt;-'))
## setMethod(f='path&lt;-', signature='Turtle', function(x, value) {slot(x, 'path') = value; x})</code></pre>
<p>To use the code, we can source it, or place in a package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/dumpcs.html">dumpcs</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">tf</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="va">tf</span><span class="op">)</span></code></pre></div>
<pre><code>## Creating a new generic function for 'path' in the global environment</code></pre>
<pre><code>## Creating a new generic function for 'path&lt;-' in the global environment</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tur</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="st">"Turtle"</span><span class="op">)</span>
<span class="va">tur</span></code></pre></div>
<pre><code>## An object of class "Turtle"
## Slot "location":
## [1] 0 0
## 
## Slot "orientation":
## [1] 0
## 
## Slot "path":
##      [,1] [,2]
## [1,]    0    0</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">path</span><span class="op">(</span><span class="va">tur</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">path</span><span class="op">(</span><span class="va">tur</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, nr<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">tur</span></code></pre></div>
<pre><code>## An object of class "Turtle"
## Slot "location":
## [1] 0 0
## 
## Slot "orientation":
## [1] 0
## 
## Slot "path":
##      [,1] [,2]
## [1,]    1    1</code></pre>
</div>
<div id="extend-the-class" class="section level2">
<h2 class="hasAnchor">
<a href="#extend-the-class" class="anchor"></a>Extend the class</h2>
<p>Stuart showed how a more functional turtle can be defined – one that holds a pen. We’ll need a new definition and new getters and setters.</p>
<p>We defined a method on our <code>ClassSupport</code> class to produce the new class.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newprops</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"pink"</span>, thickness <span class="op">=</span> <span class="fl">1</span>, on <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="../reference/extendClassSupport.html">extendClassSupport</a></span><span class="op">(</span><span class="va">tt</span>, <span class="va">newprops</span>, <span class="st">"TurtleWithPen"</span><span class="op">)</span>
<span class="va">nn</span></code></pre></div>
<pre><code>## ClassSupport instance for TurtleWithPen 
##  slots:  colour thickness on</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dumpcs.html">dumpcs</a></span><span class="op">(</span><span class="va">nn</span><span class="op">)</span></code></pre></div>
<pre><code>## setClass('TurtleWithPen', contains='Turtle', slots=c(colour='character', thickness='numeric', on='logical'))
## setGeneric(name='colour', def=function(x) standardGeneric('colour'))
## setMethod(f='colour', signature='TurtleWithPen', function(x) slot(x, 'colour'))
## setGeneric(name='thickness', def=function(x) standardGeneric('thickness'))
## setMethod(f='thickness', signature='TurtleWithPen', function(x) slot(x, 'thickness'))
## setGeneric(name='on', def=function(x) standardGeneric('on'))
## setMethod(f='on', signature='TurtleWithPen', function(x) slot(x, 'on'))
## setGeneric(name='colour&lt;-', def=function(x, value) standardGeneric('colour&lt;-'))
## setMethod(f='colour&lt;-', signature='TurtleWithPen', function(x, value) {slot(x, 'colour') = value; x})
## setGeneric(name='thickness&lt;-', def=function(x, value) standardGeneric('thickness&lt;-'))
## setMethod(f='thickness&lt;-', signature='TurtleWithPen', function(x, value) {slot(x, 'thickness') = value; x})
## setGeneric(name='on&lt;-', def=function(x, value) standardGeneric('on&lt;-'))
## setMethod(f='on&lt;-', signature='TurtleWithPen', function(x, value) {slot(x, 'on') = value; x})</code></pre>
<p>We can now source that code to allow composition of methods for TurtleWithPen.</p>
</div>
</div>
<div id="envoi" class="section level1">
<h1 class="hasAnchor">
<a href="#envoi" class="anchor"></a>Envoi</h1>
<p>There is something unsavory about this approach to code generation. I produced it in the face of a task involving a configuration object that seems to require many slots. I wanted to avoid the temptation to use simple functions and the at sign. My hope is that programs along the lines of those demonstrated here will help lower the barrier to adoption of formal class and method definitions in R programming. There are surely many improvements to be made in what has been proposed here.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VJ Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
